---
title: "Homework 1-Univar"
output:
  html_document:
    df_print: paged
---
 
```{r libraries, eval=TRUE}
# call libraries:
library(ggplot2)
library(haven)
```

```{r loaddata, eval=TRUE}
# import data (~800mb):
datalink='https://dl.dropboxusercontent.com/s/xhs2utpj1wntmzt/BRFSSFinalSup.dta'
brfssdata=read_dta(datalink)
```

```{r removena, eval=TRUE}
brfssdata2=brfssdata[complete.cases(brfssdata), ]
```

```{r barplotprep,eval=TRUE}
mentalT=table(brfssdata2$mental,exclude=0)

MentalT2=prop.table(mentalT)
MentalT2=MentalT2*100

MentalTdf=as.data.frame(MentalT2)
names(MentalTdf)=c("mentd","Frequency")
MentalTdf
```


```{r univar, eval=TRUE}
### Univariate graph
source="BRFSS Survey Data 2000-2018"
ttl="Proportion of Negative Mental Health Cases Reported (in Days)"

plot1=ggplot(data=MentalTdf, aes(x=mentd, y=Frequency))
plot2=plot1 + geom_bar(fill ="grey", 
                       col="black",
                       lwd=0.3,
                       stat = 'identity')+ 
              geom_text(aes(y =Frequency, 
                            label = paste0(round(Frequency,2), '%')),
                        hjust=-0.09, 
                        size = 3) +
              coord_flip()
  
plot3=plot2 + scale_y_continuous(breaks=seq(0,18, by=3),
                                 limits = c(0, 18), 
                                 labels=scales::unit_format(suffix = '%'))     
plot4 = plot3 + labs(title=ttl,
                     x="Days", 
                     y="Percent",
                     caption=source)

plot5 = plot4 + theme(panel.background = element_rect(fill = "white",colour = "grey20"),
                      plot.caption = element_text(hjust = 0), 
                      plot.title = element_text(hjust = 0.5),
                      axis.text.y= element_text(size=8))
plot5
```
```{r}
### Bivariate graph
#str(brfssdata$mental)
#crimeYearGG=crimeY2000[complete.cases(crimeY2000$YearsToReport),]
mentalbiv=table(brfssdata2$mental,brfssdata2$stab)

biv=prop.table(mentalbiv)
biv=biv*100

bivdata=as.data.frame(biv)
names(bivdata)=c("Days","State","Frequency")
bivdata
```
```{r}
boxbase = ggplot(data=bivdata, aes(x=State, y=Days))
#ggplot(MentalTdf,aes(x=factor(mentd), y=Frequency())) 
box  = boxbase + geom_boxplot()
box
```

```{r}
boxplot(mental~stab,data=brfssdata2[(brfssdata2$mental>0),])
```



```{r}
table(brfssdata2$ex2018,exclude = 'nothing')
```




