alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.55,label="mean",size=3,alpha=0.7)+
annotate("text",x=2012.5,y=2.25,label="ACA Expension",size=3,alpha=0.7)+
scale_color_manual(values = c("steelblue","darkred"))
# Multi-variate Visualization: line plot for sex, income, and education level:
## this plot shows the average mental health number reported each year for
## states that expanded ACA vs. states that didnt expand ACA
titlesex="Negative Mental Health Days by Sex by Expansion Group"
ggplot(dfsex, aes(x=year, y = mentavg, group = sex)) +
geom_line(aes(color=sex)) +
geom_vline(xintercept=2014) +
scale_x_continuous(breaks=c(2000:2017)) +
scale_y_continuous(breaks=c(2.5,2.7,2.9,3.0,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4.0)) +
labs(title=titlesex, x="Year", y="Days",caption=source1) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1)) +
facet_grid(ex2014~.) +#gender? Income bracket? Income bracket?
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.55,label="mean",size=3,alpha=0.7)+
annotate("text",x=2012.5,y=2.25,label="ACA Expension",size=3,alpha=0.7)+
scale_color_manual(values = c("steelblue","darkred"))
# Multi-variate Visualization: line plot for sex, income, and education level:
## this plot shows the average mental health number reported each year for
## states that expanded ACA vs. states that didnt expand ACA
titlesex="Negative Mental Health Days by Sex by Expansion Group"
ggplot(dfsex, aes(x=year, y = mentavg, group = sex)) +
geom_line(aes(color=sex)) +
geom_vline(xintercept=2014) +
scale_x_continuous(breaks=c(2000:2017)) +
scale_y_continuous(breaks=c(2.5,2.7,2.9,3.1,3.3,3.5,3.7,3.9)) +
labs(title=titlesex, x="Year", y="Days",caption=source1) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1)) +
facet_grid(ex2014~.) +#gender? Income bracket? Income bracket?
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.55,label="mean",size=3,alpha=0.7)+
annotate("text",x=2012.5,y=2.25,label="ACA Expension",size=3,alpha=0.7)+
scale_color_manual(values = c("steelblue","darkred"))
# Multi-variate Visualization: line plot for sex, income, and education level:
## this plot shows the average mental health number reported each year for
## states that expanded ACA vs. states that didnt expand ACA
titlesex="Negative Mental Health Days by Sex by Expansion Group"
ggplot(dfsex, aes(x=year, y = mentavg, group = sex)) +
geom_line(aes(color=sex)) +
geom_vline(xintercept=2014) +
scale_x_continuous(breaks=c(2000:2017)) +
scale_y_continuous(breaks=c(2.5,2.7,2.9,3.1,3.3,3.5,3.7,3.9,4.1,4.3)) +
labs(title=titlesex, x="Year", y="Days",caption=source1) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1)) +
facet_grid(ex2014~.) +#gender? Income bracket? Income bracket?
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.55,label="mean",size=3,alpha=0.7)+
annotate("text",x=2012.5,y=2.25,label="ACA Expension",size=3,alpha=0.7)+
scale_color_manual(values = c("steelblue","darkred"))
# Multi-variate Visualization: line plot for sex, income, and education level:
## this plot shows the average mental health number reported each year for
## states that expanded ACA vs. states that didnt expand ACA
titlesex="Negative Mental Health Days by Sex by Expansion Group"
ggplot(dfsex, aes(x=year, y = mentavg, group = sex)) +
geom_line(aes(color=sex)) +
geom_vline(xintercept=2014) +
scale_x_continuous(breaks=c(2000:2017)) +
scale_y_continuous(breaks=c(2.5,2.7,2.9,3.1,3.3,3.5,3.7,3.9,4.1)) +
labs(title=titlesex, x="Year", y="Days",caption=source1) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1)) +
facet_grid(ex2014~.) +#gender? Income bracket? Income bracket?
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.55,label="mean",size=3,alpha=0.7)+
annotate("text",x=2012.5,y=2.25,label="ACA Expension",size=3,alpha=0.7)+
scale_color_manual(values = c("steelblue","darkred"))
# Multi-variate Visualization: line plot for sex, income, and education level:
## this plot shows the average mental health number reported each year for
## states that expanded ACA vs. states that didnt expand ACA
titlesex="Negative Mental Health Days by Sex by Expansion Group"
ggplot(dfsex, aes(x=year, y = mentavg, group = sex)) +
geom_line(aes(color=sex)) +
geom_vline(xintercept=2014) +
scale_x_continuous(breaks=c(2000:2017)) +
scale_y_continuous(breaks=c(1,	1.2,	1.4,	1.6,	1.8,	2,	2.2,	2.4,	2.6,	2.8,	3,	3.2,	3.4,	3.6,	3.8,	4,	4.2)) +
labs(title=titlesex, x="Year", y="Days",caption=source1) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1)) +
facet_grid(ex2014~.) +#gender? Income bracket? Income bracket?
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.55,label="mean",size=3,alpha=0.7)+
annotate("text",x=2012.5,y=2.25,label="ACA Expension",size=3,alpha=0.7)+
scale_color_manual(values = c("steelblue","darkred"))
# Multi-variate Visualization: line plot for sex, income, and education level:
## this plot shows the average mental health number reported each year for
## states that expanded ACA vs. states that didnt expand ACA
titlesex="Negative Mental Health Days by Sex by Expansion Group"
ggplot(dfsex, aes(x=year, y = mentavg, group = sex)) +
geom_line(aes(color=sex)) +
geom_vline(xintercept=2014) +
scale_x_continuous(breaks=c(2000:2017)) +
scale_y_continuous(breaks=c(1,1.2,1.4,1.6,1.8,2,2.2,2.4,2.6,2.8,3,3.2,3.4,3.6,3.8,4,4.2)) +
labs(title=titlesex, x="Year", y="Days",caption=source1) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1)) +
facet_grid(ex2014~.) +#gender? Income bracket? Income bracket?
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.55,label="mean",size=3,alpha=0.7)+
annotate("text",x=2012.5,y=2.25,label="ACA Expension",size=3,alpha=0.7)+
scale_color_manual(values = c("steelblue","darkred"))
View(brfssdata)
#these four states expanded ACA after 2014 ("AK" "LA" "MT" "PA") and are excluded from the results:
brfssdata$stab=as.character(brfssdata$stab)
bad=unique(brfssdata$stab[(brfssdata$ex2014 == 0 & brfssdata$ex2016 == 1)])
bad
type(brfssdata)
#these four states expanded ACA after 2014 ("AK" "LA" "MT" "PA") and are excluded from the results:
brfssdata$stab=as.character(brfssdata$stab)
bad=unique(brfssdata$stab[(brfssdata$ex2014 == 0 & brfssdata$ex2016 == 1)])
bad
typeof(brfssdata)
#This chunk removes states that do not fit neatly into the categories we use in our plots. These four states expanded ACA after 2014 ("AK" "LA" "MT" "PA") and are excluded from the results:
brfssdata$stab=as.character(brfssdata$stab) #convert stab into numeric
bad=unique(brfssdata$stab[(brfssdata$ex2014 == 0 & brfssdata$ex2016 == 1)]) #create a list of the bad states
bad # show us the bad states
#Data prep for visualization: Calculate annual mental averages grouped  (expansion and non-expansion groups separated)
#pipe=%>% (this is from dplyr)
dfmelt=brfssdata%>%
select(year, stab, mental, ex2014)%>%
filter(stab %nin% bad)%>%
filter(!is.na(ex2014))%>%
group_by(year,ex2014)%>%
mutate(mentavg=mean(mental, na.rm = TRUE))%>%
ungroup()%>%
select(year, ex2014,mentavg)%>%
unique()%>%
mutate(ex2014=ifelse(ex2014==0, "No Expansion", "Expansion"))
# import data (~90mb each)
#this chunk imports the csv files that the previous two chunks uploaded to Github. Because these files are under 100mb, they were able to be uploaded
brfssdata=read.csv("https://github.com/cazvan/599B_Final/raw/master/brfss.csv")
brfssdata2=read.csv("https://github.com/cazvan/599B_Final/raw/master/brfss2.csv")
#This chunk removes states that do not fit neatly into the categories we use in our plots. These four states expanded ACA after 2014 ("AK" "LA" "MT" "PA") and are excluded from the results:
brfssdata$stab=as.character(brfssdata$stab) #convert stab into numeric
bad=unique(brfssdata$stab[(brfssdata$ex2014 == 0 & brfssdata$ex2016 == 1)]) #create a list of the bad states
bad # show us the bad states
#Data prep for visualization: Calculate annual mental averages grouped  (expansion and non-expansion groups separated)
#pipe=%>% (this is from dplyr)
dfmelt=brfssdata%>%
select(year, stab, mental, ex2014)%>%
filter(stab %nin% bad)%>%
filter(!is.na(ex2014))%>%
group_by(year,ex2014)%>%
mutate(mentavg=mean(mental, na.rm = TRUE))%>%
ungroup()%>%
select(year, ex2014,mentavg)%>%
unique()%>%
mutate(ex2014=ifelse(ex2014==0, "No Expansion", "Expansion"))
#View(dfmelt) # view the dataframe to verify results
# Bi-variate Visualization: Line plot
## this plot shows the average mental health number reported each year for
## states that expanded ACA vs. states that didnt expand ACA
ggplot(dfmelt, aes(x=year, y = mentavg, group = ex2014)) +
labs(title=title1, x="Years", y="Average Mental Health Days",caption=source1) +
geom_line(aes(color=ex2014)) +
geom_vline(xintercept=2014,size=1, alpha=0.5) +
scale_x_continuous(breaks=c(2000:2017)) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1))+
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.455,label="mean",size=3,alpha=0.7)+
annotate("text",x=2015.59,y=3.28,label="ACA Expension",size=3,alpha=0.7)+
scale_color_manual(values = c("steelblue","darkred"))
# Bi-variate Visualization: Line plot
## this plot shows the average mental health number reported each year for
## states that expanded ACA vs. states that didnt expand ACA
titlebi="Average Negative Mental Health Days Over Last 30 Days"
ggplot(dfmelt, aes(x=year, y = mentavg, group = ex2014)) +
labs(title=titlebi, x="Years", y="Average Mental Health Days",caption=source1) +
geom_line(aes(color=ex2014)) +
geom_vline(xintercept=2014,size=1, alpha=0.5) +
scale_x_continuous(breaks=c(2000:2017)) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1))+
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.455,label="mean",size=3,alpha=0.7)+
annotate("text",x=2015.59,y=3.28,label="ACA Expension",size=3,alpha=0.7)+
scale_color_manual(values = c("steelblue","darkred"))
# Bi-variate Visualization: Line plot
## this plot shows the average mental health number reported each year for
## states that expanded ACA vs. states that didnt expand ACA
titlebi="Average Negative Mental Health Days Over Last 30 Days"
source1="BRFSS Survey Data 2000-2018"
ggplot(dfmelt, aes(x=year, y = mentavg, group = ex2014)) +
labs(title=titlebi, x="Years", y="Average Mental Health Days",caption=source1) +
geom_line(aes(color=ex2014)) +
geom_vline(xintercept=2014,size=1, alpha=0.5) +
scale_x_continuous(breaks=c(2000:2017)) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1))+
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.455,label="mean",size=3,alpha=0.7)+
annotate("text",x=2015.59,y=3.28,label="ACA Expension",size=3,alpha=0.7)+
scale_color_manual(values = c("steelblue","darkred"))
# Multi-variate Visualization: line plot for sex, income, and education level:
## this plot shows the average mental health number reported each year for
## states that expanded ACA vs. states that didnt expand ACA
titlesex="Negative Mental Health Days by Sex by Expansion Group"
ggplot(dfsex, aes(x=year, y = mentavg, group = sex)) +
geom_line(aes(color=sex)) +
geom_vline(xintercept=2014) +
scale_x_continuous(breaks=c(2000:2017)) +
scale_y_continuous(breaks=c(1,1.2,1.4,1.6,1.8,2,2.2,2.4,2.6,2.8,3,3.2,3.4,3.6,3.8,4,4.2)) +
labs(title=titlesex, x="Year", y="Days",caption=source1) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1)) +
facet_grid(ex2014~.) +#gender? Income bracket? Income bracket?
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.55,label="mean",size=3,alpha=0.7)+
annotate("text",x=2012.5,y=2.25,label="ACA Expension",size=3,alpha=0.7)+
scale_color_manual(values = c("steelblue","darkred"))
#Univariate Visualization: Line Plot NEW YAY
source1="BRFSS Survey Data 2000-2018"
title1="Average Negative Mental Health Days Over Last 30 Days"
ggplot(dfmelt2,aes(x=year, y = mentavg2)) +
labs(title=title1, x="Year", y="Days",caption=source1) +
geom_line(color="steelblue",aes(), show.legend = TRUE) +
#geom_vline(xintercept=2014) +
scale_x_continuous(breaks=c(2000:2017)) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1)) +
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.455,label="mean",size=3,alpha=0.7)
#Univariate Visualization: barplot
source1="BRFSS Survey Data 2000-2018"
title1="Survey Count by Year"
yearplot=ggplot(data= brfssdata, aes(x=year)) +
geom_bar(stat = "count", fill="steelblue") +
labs(title=title1, x=NULL, y=NULL,caption=source1) +
scale_y_continuous(labels = scales::comma) +
scale_x_continuous(breaks=c(2000:2017)) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = -30, hjust = 0))
yearplot
#Data prep for visualization: Calculating annual mental averages ungrouped (expansion and non-expansion groups together, by year)
#dataframe
#pipe=%>% (this is from dplyr)
dfmelt2=brfssdata%>%
select(year, stab, mental)%>%
filter(stab %nin% bad)%>%
group_by(year)%>%
mutate(mentavg2=mean(mental, na.rm = TRUE))%>%
ungroup()%>%
select(year,mentavg2)%>%
unique()
#View(dfmelt2)
#Univariate Visualization: Line Plot NEW YAY
source1="BRFSS Survey Data 2000-2018"
title1="Average Negative Mental Health Days Over Last 30 Days"
ggplot(dfmelt2,aes(x=year, y = mentavg2)) +
labs(title=title1, x="Year", y="Days",caption=source1) +
geom_line(color="steelblue",aes(), show.legend = TRUE) +
#geom_vline(xintercept=2014) +
scale_x_continuous(breaks=c(2000:2017)) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1)) +
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.455,label="mean",size=3,alpha=0.7)
#Univariate Visualization: Line Plot NEW YAY
source1="BRFSS Survey Data 2000-2018"
title1="Average Negative Mental Health Days Over Last 30 Days"
ggplot(dfmelt,aes(x=year, y = mentavg2)) +
labs(title=title1, x="Year", y="Days",caption=source1) +
geom_line(color="steelblue",aes(), show.legend = TRUE) +
#geom_vline(xintercept=2014) +
scale_x_continuous(breaks=c(2000:2017)) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1)) +
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.455,label="mean",size=3,alpha=0.7)
#Univariate Visualization: Line Plot NEW YAY
source1="BRFSS Survey Data 2000-2018"
title1="Average Negative Mental Health Days Over Last 30 Days"
ggplot(dfmelt,aes(x=year, y = mentavg)) +
labs(title=title1, x="Year", y="Days",caption=source1) +
geom_line(color="steelblue",aes(), show.legend = TRUE) +
#geom_vline(xintercept=2014) +
scale_x_continuous(breaks=c(2000:2017)) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1)) +
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.455,label="mean",size=3,alpha=0.7)
#Univariate Visualization: Line Plot NEW YAY
source1="BRFSS Survey Data 2000-2018"
title1="Average Negative Mental Health Days Over Last 30 Days"
ggplot(dfmelt2,aes(x=year, y = mentavg2)) +
labs(title=title1, x="Year", y="Days",caption=source1) +
geom_line(color="steelblue",aes(), show.legend = TRUE) +
#geom_vline(xintercept=2014) +
scale_x_continuous(breaks=c(2000:2017)) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1)) +
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.455,label="mean",size=3,alpha=0.7)
# Bi-variate Visualization: Line plot
## this plot shows the average mental health number reported each year for
## states that expanded ACA vs. states that didnt expand ACA
titlebi="Average Negative Mental Health Days Over Last 30 Days"
source1="BRFSS Survey Data 2000-2018"
ggplot(dfmelt, aes(x=year, y = mentavg, group = ex2014)) +
labs(title=titlebi, x="Years", y="Average Mental Health Days",caption=source1) +
geom_line(aes(color=ex2014)) +
geom_vline(xintercept=2014,size=1, alpha=0.5) +
scale_x_continuous(breaks=c(2000:2017)) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1))+
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.455,label="mean",size=3,alpha=0.7)+
annotate("text",x=2015.59,y=3.28,label="ACA Expension",size=3,alpha=0.7)+
scale_color_manual(values = c("steelblue","darkred"))
#scale_y_continuous(expand =
#facet_grid(ex2014~.) #gender? Income bracket?
#add mean behavior line? Add annotation instead of reference line for 2014?
# Multi-variate Visualization: line plot for sex, income, and education level:
## this plot shows the average mental health number reported each year for
## states that expanded ACA vs. states that didnt expand ACA
titlesex="Negative Mental Health Days by Sex by Expansion Group"
ggplot(dfsex, aes(x=year, y = mentavg, group = sex)) +
geom_line(aes(color=sex)) +
geom_vline(xintercept=2014) +
scale_x_continuous(breaks=c(2000:2017)) +
scale_y_continuous(breaks=c(1,1.2,1.4,1.6,1.8,2,2.2,2.4,2.6,2.8,3,3.2,3.4,3.6,3.8,4,4.2)) +
labs(title=titlesex, x="Year", y="Days",caption=source1) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1)) +
facet_grid(ex2014~.) +#gender? Income bracket? Income bracket?
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.55,label="mean",size=3,alpha=0.7)+
annotate("text",x=2012.5,y=2.25,label="ACA Expension",size=3,alpha=0.7)+
scale_color_manual(values = c("steelblue","darkred"))
#Data prep for multivariate visualization, averaging annual negative mental health days by year, sex, and expansion vs. non-expansion state
#pipe=%>% (this is from dplyr)
dfsex=brfssdata2%>% # name the new frame, use the second list
select(year, stab, mental, ex2014, sex)%>% #select the variables to be used
filter(stab %nin% bad)%>% #filter out the bad states
filter(!is.na(ex2014))%>% #filter out n/a answers from ex2014
group_by(sex,year,ex2014)%>% #group by sec, year, and ex2014 variables
mutate(mentavg=mean(mental, na.rm = TRUE))%>% #create a new variable for average mental days by sex,year, and expansion group
ungroup()%>% #ungroup the grouped variables
select(year, ex2014,mentavg,sex)%>% #select the 4 variables to be used
unique()%>% #group into unique answers
mutate(ex2014=ifelse(ex2014==0, "No ACA Expansion", "ACA Expansion"))%>% #rename expansion variable
filter((year!=2018)) #remove responses from 2018
#rename the binary sex variable to "male" and "female"
dfsex$sex <- ordered(dfsex$sex, #order the variable from 1 to 0
levels = c(1,0), #select the binary numbers
labels = c("Males", "Females")) # choose the new names
#View(dfsex)
#Univariate Visualization: barplot
source1="BRFSS Survey Data 2000-2018"
titlecount="Survey Count by Year"
yearplot=ggplot(data= brfssdata, aes(x=year)) +
geom_bar(stat = "count", fill="steelblue") +
labs(title=titlecount, x=NULL, y=NULL,caption=source1) +
scale_y_continuous(labels = scales::comma) +
scale_x_continuous(breaks=c(2000:2017)) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = -30, hjust = 0))
yearplot
#Univariate Visualization: Line Plot NEW YAY
source1="BRFSS Survey Data 2000-2018"
title1="Average Negative Mental Health Days Over Last 30 Days"
ggplot(dfmelt2,aes(x=year, y = mentavg2)) +
labs(title=title1, x="Year", y="Days",caption=source1) +
geom_line(color="steelblue",aes(), show.legend = TRUE) +
#geom_vline(xintercept=2014) +
scale_x_continuous(breaks=c(2000:2017)) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1)) +
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.455,label="mean",size=3,alpha=0.7)
# Multi-variate Visualization: line plot for sex, income, and education level:
## this plot shows the average mental health number reported each year for
## states that expanded ACA vs. states that didnt expand ACA
titlesex="Negative Mental Health Days by Sex by Expansion Group"
ggplot(dfsex, aes(x=year, y = mentavg, group = sex)) +
geom_line(aes(color=sex)) +
geom_vline(xintercept=2014) +
scale_x_continuous(breaks=c(2000:2017)) +
scale_y_continuous(breaks=c(1,1.2,1.4,1.6,1.8,2,2.2,2.4,2.6,2.8,3,3.2,3.4,3.6,3.8,4,4.2)) +
labs(title=titlesex, x="Year", y="Days",caption=source1) +
theme(panel.background = element_rect(fill = "white",colour = "grey50"),
plot.caption = element_text(hjust = 0), # default was 1
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 30, hjust = 1)) +
facet_grid(ex2014~.) +#gender? Income bracket? Income bracket?
geom_hline(yintercept = mean(dfmelt2$mentavg2), #where
linetype="dashed",
size=1, #thickness
alpha=0.5)+
theme(legend.title = element_blank())+
annotate("text",x=2017,y=3.55,label="mean",size=3,alpha=0.7)+
annotate("text",x=2012.5,y=2.25,label="ACA Expension",size=3,alpha=0.7)+
scale_color_manual(values = c("steelblue","darkred"))
